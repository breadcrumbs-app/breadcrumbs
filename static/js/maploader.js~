function initialize() {	
    var location = function(){
	var position;
	
	
	function showPosition(position) {
	    console.log("Latitude: " + position.coords.latitude);
	    
	    //x.innerHTML = "Latitude: " + position.coords.latitude + 
		//"<br>Longitude: " + position.coords.longitude; 
	}	

	if (navigator.geolocation) {
	    navigator.geolocation.getCurrentPosition(
		position = function(pos) {
		   return {
		       "latitude" : position.coords.latitude,
		       "longitude": position.coords.longitude
		   };
	    	}
			
		
		
	    }, function(error){	
		switch(error.code) {
		    case error.PERMISSION_DENIED:
			console.log("User denied permission.");
		    break;
		    case error.POSITION_UNAVAILABLE:
			console.log("Geolocation/GPS unavailable.");
		    break;
		    case error.TIMEOUT:
			console.log("Geolocation request timed out.");
		    break;
		    case error.UNKNOWN_ERROR:
			console.log("Something wack happened.");
		    break;
		});
	
	    /*
	    navigator.geolocation.getCurrentPosition( function(pos) {
		console.log(pos.coords.latitude);
		position['lat'] = pos.coords.latitude;
		position['long'] = pos.coords.longitude;
		});
	    */	
	    console.log(position);
	} else {
	    alert("Please allow location to be found.\n");	
	}
	console.log(position);
	return position;
    }();

    return function() {
	var mapCanvas = document.getElementById('map-canvas');
	var mapOptions = {
	    center: new google.maps.LatLng(
		location.coords.latitude,
		location.coords.longitude),
		zoom: 8,
		mapTypeId: google.maps.MapTypeId.ROADMAP
	}
	var map = new google.maps.Map(mapCanvas, mapOptions);
    }
}

google.maps.event.addDomListener(window, 'load', initialize);
